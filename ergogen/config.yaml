meta:
  engine: 4.0.4
  author: "@infused-kim"
  name: 'ThinkCorney'
  version: v1-b1
  full_name: &kb_full_name 'ThinkCorney v1-b1'

settings:
  preset:
    $extends: presets.kim
  point_debugger:
    enabled: true

presets:
  corne_choc:
    # Stagger
    cfg_stagger_outer: 0
    cfg_stagger_pinky: 0
    cfg_stagger_ring: 4.75
    cfg_stagger_middle: 2.375
    cfg_stagger_index: -2.375
    cfg_stagger_inner: -2.375

    # Splay
    cfg_splay_outer: 0
    cfg_splay_pinky: 0
    cfg_splay_ring: 0
    cfg_splay_middle: 0
    cfg_splay_index: 0
    cfg_splay_inner: 0
    cfg_splay_thumb_home: -15
    cfg_splay_thumb_inner: -15

    # Key Size
    cfg_kx: cx
    cfg_ky: cy
    cfg_keycaps_x: 17.5
    cfg_keycaps_y: 16.5

    # Thumb Cluster offset from bottom index finger key
    cfg_thumb_cluster_offset_x: -8.5
    cfg_thumb_cluster_offset_y: -19.625

    # Distance adjustment of thumb key to align with rotation
    cfg_thumb_home_move_x:  2
    cfg_thumb_home_move_y: -2.7
    cfg_thumb_inner_move_x: 2.7
    cfg_thumb_inner_move_y: 2.3

    # Top & Bottom padding for outline
    cfg_pcb_outline_padding_top: 0.1
    cfg_pcb_outline_padding_left: 0
    cfg_pcb_outline_padding_right: 0

    # 1.5u rotated inner thumb settings
    cfg_splay_thumb_inner_extra: 90
    cfg_keycaps_thumb_inner_x: 26.5
    cfg_keycaps_thumb_inner_y: 16.5
    cfg_thumb_inner_width: 1.5
    cfg_edge_thumb_cluster_top_shift_x: cfg_thumb_inner_width * 0.5 * cfg_kx
    cfg_edge_thumb_cluster_top_shift_y: -0.5 * cfg_ky
    cfg_edge_thumb_cluster_bottom_shift_x: -0.5 * cfg_kx * cfg_thumb_inner_width - cfg_pcb_outline_padding_top
    cfg_edge_thumb_cluster_bottom_shift_y: 0

  corne_choc_mx_spacing:
    $extends: presets.corne_choc

    # Key size
    cfg_kx: u
    cfg_ky: u

    # Thumb Cluster offset from bottom index finger key
    cfg_thumb_cluster_offset_x: -9.5

    # Distance adjustment of inner thumb key
    cfg_thumb_inner_move_x: 3.504
    cfg_thumb_inner_move_y: 2.07

    # Top & Bottom padding for outline
    cfg_pcb_outline_padding_top: -0.35
    cfg_pcb_outline_padding_left: -0.5

  chocofi:
    $extends: presets.corne_choc

    # Stagger
    cfg_stagger_ring: 12
    cfg_stagger_middle: 6
    cfg_stagger_index: -6.62
    cfg_stagger_inner: -2.38

    # Thumb Cluster offset from bottom index finger key
    cfg_thumb_cluster_offset_x: -6
    cfg_thumb_cluster_offset_y: -20

    # Spacing required for outline to get a straight edge for the inner side
    cfg_thumb_edge_offset: 0

    cfg_pcb_outline_padding_right: 1.2

  kim:
    $extends: presets.corne_choc

    # Stagger
    cfg_stagger_ring: 15
    cfg_stagger_middle: 4
    cfg_stagger_index: -8
    cfg_stagger_inner: -2.38

    # Splay
    cfg_splay_outer: 4
    cfg_splay_pinky: 0
    cfg_splay_ring: -4
    cfg_splay_middle: 0
    cfg_splay_index: 0
    cfg_splay_inner: 0
    cfg_splay_thumb_home: 0
    cfg_splay_thumb_inner: -15

    # Thumb Cluster offset from bottom index finger key
    cfg_thumb_cluster_offset_x: -8.5
    cfg_thumb_cluster_offset_y: -21

    # Distance adjustment of thumb key to align with rotation
    cfg_thumb_home_move_x: 0
    cfg_thumb_home_move_y: 0
    cfg_thumb_inner_move_x: 1.8
    cfg_thumb_inner_move_y: -2.65

    cfg_pcb_outline_padding_right: 0

    # Make the inner thumb 1u instead of 1.5u and don't rotate it
    cfg_splay_thumb_inner_extra: 0
    cfg_thumb_inner_width: 1
    cfg_keycaps_thumb_inner_x: 17.5
    cfg_keycaps_thumb_inner_y: 16.5
    cfg_edge_thumb_cluster_top_shift_x: cfg_thumb_inner_width * 0.5 * cfg_kx
    cfg_edge_thumb_cluster_top_shift_y: 0.5 * cfg_ky
    cfg_edge_thumb_cluster_bottom_shift_x: 0
    cfg_edge_thumb_cluster_bottom_shift_y: -0.5 * cfg_ky * cfg_thumb_inner_width

units:
  $extends: settings.preset

  # Stagger
  stagger_outer: cfg_stagger_outer
  stagger_pinky: cfg_stagger_pinky
  stagger_ring: cfg_stagger_ring
  stagger_middle: cfg_stagger_middle
  stagger_index: cfg_stagger_index
  stagger_inner: cfg_stagger_inner

  # Finger splay
  splay_outer: cfg_splay_outer
  splay_pinky: cfg_splay_pinky
  splay_ring: cfg_splay_ring
  splay_middle: cfg_splay_middle
  splay_index: cfg_splay_index
  splay_inner: cfg_splay_inner

  # Thumb key splay
  splay_thumb_home: cfg_splay_thumb_home
  splay_thumb_inner: cfg_splay_thumb_inner
  splay_thumb_inner_extra: cfg_splay_thumb_inner_extra

  # Thumb key width
  thumb_inner_width: cfg_thumb_inner_width

  # Key Spacing
  # cx and cy are ergogen's choc spacing units.
  kx: cfg_kx
  ky: cfg_ky
  kxo: 0.5 * kx
  kyo: 0.5 * ky
  px: kx + 2
  py: ky + 2

  # Keycap Size
  # Ergogen's automatically adds 0.5mm to the cx and cy units
  # to add spacing between the keys.
  # The numbers below are the actual keycap sizes that will be displayed
  # in the pcb to check proper alignment and spacing
  keycaps_x: cfg_keycaps_x
  keycaps_y: cfg_keycaps_y
  keycaps_thumb_inner_x: cfg_keycaps_thumb_inner_x
  keycaps_thumb_inner_y: cfg_keycaps_thumb_inner_y
  keycaps_thumb_inner_xo: 0.5 * keycaps_thumb_inner_x
  keycaps_thumb_inner_yo: 0.5 * keycaps_thumb_inner_y

  # Thumb Cluster offset from bottom index finger key
  thumb_cluster_offset_x: cfg_thumb_cluster_offset_x
  thumb_cluster_offset_y: cfg_thumb_cluster_offset_y

  # Thumb Cluster Offsets
  thumb_home_move_x: cfg_thumb_home_move_x
  thumb_home_move_y: cfg_thumb_home_move_y
  thumb_inner_move_x: cfg_thumb_inner_move_x
  thumb_inner_move_y: cfg_thumb_inner_move_y

  # PCB Outline Padding
  pcb_outline_padding_top: cfg_pcb_outline_padding_top
  pcb_outline_padding_bottom: cfg_pcb_outline_padding_top
  pcb_outline_padding_left: cfg_pcb_outline_padding_left
  pcb_outline_padding_right: cfg_pcb_outline_padding_right

  # Inner thumb settings
  edge_thumb_cluster_top_shift_x: cfg_edge_thumb_cluster_top_shift_x
  edge_thumb_cluster_top_shift_y: cfg_edge_thumb_cluster_top_shift_y
  edge_thumb_cluster_bottom_shift_x: cfg_edge_thumb_cluster_bottom_shift_x
  edge_thumb_cluster_bottom_shift_y: cfg_edge_thumb_cluster_bottom_shift_y

  # Font units
  font_x: 1
  font_y: 1
  font_xo: 0.5 font_x
  font_yo: 0.5 * font_y

  # Nice Nano
  # The nice nano footprint's center doesn't account
  mcu_spacing_left: 1.25
  mcu_spacing_right: 1.5
  mcu_x: 17.78
  mcu_y: 33.0
  mcu_xo: 0.5 * mcu_x
  mcu_yo: 0.5 * mcu_y

  # Nice!View display
  disp_x: 14
  disp_y: 36
  disp_jumper_y: 2.6
  disp_xo: 0.5 * disp_x
  disp_yo: 0.5 * disp_y

  # Battery Connector
  batc_x: 4.3
  batc_y: 4.6
  batc_xo: 0.5 * batc_x
  batc_yo: 0.5 * batc_y

  # Battery Pads
  batp_x: 3.75
  batp_y: 2.5
  batp_xo: 0.5 * batp_x
  batp_yo: 0.5 * batp_y

  # Power Switch
  sw_power_x: 3.1
  sw_power_y: 8.3
  sw_power_xo: 0.5 * sw_power_x
  sw_power_yo: 0.5 * sw_power_y

  # Reset Switch
  sw_reset_x: 3.4
  sw_reset_y: 5
  sw_reset_xo: 0.5 * sw_reset_x
  sw_reset_yo: 0.5 * sw_reset_y

  # Trackpoint Mount
  tpm_x: 7.8
  tpm_y: 23.3
  tpm_xo: 0.5 * tpm_x
  tpm_yo: 0.5 * tpm_y

  # Trackpoint Connector
  tpc_x: 9
  tpc_y: 4.8
  tpc_xo: 0.5 * tpc_x
  tpc_yo: 0.5 * tpc_y

  # Battery Wire Cutout
  bat_wire_cutout_offset: 1
  bat_wire_cutout_width: 2.5
  bat_wire_cutout_height: 4

points:
  zones:

    #
    # Main Key Matrix
    #
    matrix:

      # Fix placement on KiCAD sheet.
      anchor:
        shift: [100, -100]

      key:
        padding: 1ky
        spread: 1kx
        tags: key

      columns:
        outer:
          key:
            stagger: stagger_outer
            splay: splay_outer
            column_net: C0
        pinky:
          key:
            stagger: stagger_pinky
            splay: splay_pinky
            column_net: C1
        ring:
          key:
            stagger: stagger_ring
            splay: splay_ring
            column_net: C2
        middle:
          key:
            stagger: stagger_middle
            splay: splay_middle
            column_net: C3
        index:
          key:
            stagger: stagger_index
            splay: splay_index
            column_net: C4
        inner:
          key:
            stagger: stagger_inner
            splay: splay_inner
            column_net: C5

      rows:
        bottom:
          row_net: R3
        home:
          row_net: R2
        top:
          row_net: R1

      # Change switch footprints for the keys around the trackpoint mount.
      # These keys need to be soldered and can't use hotswap sockets.
      #
      # Flip so that the socket is further away from the trackpoint mounting
      columns.index.rows.top.tags: key_tp_flipped
      # Flip so that the hotswap pad is not cut off by the trackpoint mounting
      # hole
      columns.index.rows.home.tags: key_tp_flipped

    #
    # Thumb Cluster
    #
    thumbs:
      key:
        padding: 1ky
        spread: 1kx
        tags: key
      anchor:
        ref: matrix_index_bottom
        shift: [thumb_cluster_offset_x, thumb_cluster_offset_y]
      columns:
        outer:
            key:
              column_net: C3
        home:
            key:
              splay: splay_thumb_home
              spread: 1kx + thumb_home_move_x
              stagger: thumb_home_move_y
              column_net: C4
        inner:
            key:
              width: kx * thumb_inner_width
              splay: splay_thumb_inner + splay_thumb_inner_extra
              spread: 1kx + thumb_inner_move_x
              stagger: thumb_inner_move_y
              tags: key_thumb_inner
              column_net: C5
      rows:
        # Thumbs only have one row.
        cluster:
          row_net: R4

    #
    #  Controller
    #
    controller:
      anchor:
        ref: matrix_inner_top
        shift: [kxo + mcu_xo + mcu_spacing_left, kyo - mcu_yo + pcb_outline_padding_top]
      key:
        name: mcu
        width: mcu_x
        height: mcu_y

    #
    # Helper Points
    #
    edge_mcu_top_right:
      anchor:
        ref: mcu
        shift: [+mcu_xo + mcu_spacing_right + pcb_outline_padding_right, +mcu_yo]

    edge_thumb_cluster_top_splayed:
      anchor:
        - ref: thumbs_inner_cluster
          shift: [edge_thumb_cluster_top_shift_x, edge_thumb_cluster_top_shift_y]
        - ref: edge_mcu_top_right
          affect: x
      key:
        name: edge_thumb_cluster_top_splayed
        # If the inner thumb is 1.5u and rotated by 90 degrees,
        # remove that rotation
        splay: -splay_thumb_inner_extra


    edge_thumb_cluster_top:
      anchor:
        - ref: edge_thumb_cluster_top_splayed
      key:
        name: edge_thumb_cluster_top
         # thumbs_inner_cluster is splayed. So here we "unsplay" it
         # to make the edge straight for placement of other components
         # along the right side outline.
        splay: -splay_thumb_home - splay_thumb_inner

    edge_thumb_cluster_bottom_tmp:
      anchor:
        ref: thumbs_inner_cluster
        shift: [edge_thumb_cluster_bottom_shift_x, edge_thumb_cluster_bottom_shift_y]
      key:
        name: edge_thumb_cluster_bottom_tmp
        # If the inner thumb is 1.5u and rotated by 90 degrees,
        # remove that rotation
        splay: -splay_thumb_inner_extra

    edge_thumb_cluster_bottom:
      anchor:
        ref:
          aggregate:
            method: intersect
            parts:
              - edge_thumb_cluster_bottom_tmp
              - edge_thumb_cluster_top_splayed
            axis1: x
            axis2: y
      key:
        name: edge_thumb_cluster_bottom

    # Part Positioning
    display:
      anchor:
        ref: mcu
        shift: [0, + mcu_yo - disp_yo - bat_wire_cutout_offset]
      key:
        name: disp
        width: disp_x
        height: disp_y

    battery_conn:
      anchor:
        ref: disp
        shift: [+batc_xo, -disp_yo - disp_jumper_y - batc_yo - 3.5 ]
      key:
        name: batc
        width: batc_x
        height: batc_y

    battery_pad:
      anchor:
        ref: batc
        shift: [0, -batc_yo - batp_yo - 3]
      key:
        name: batp
        width: batp_x
        height: batp_y

    power_switch:
      anchor:
        ref: edge_thumb_cluster_top
        shift: [-sw_power_xo - 0.5, +sw_power_yo + 1]
      key:
        name: sw_power
        width: sw_power_x
        height: sw_power_y

    reset_switch:
      anchor:
        ref: sw_power
        shift: [+sw_power_xo - sw_reset_xo - 0.1, +sw_power_yo + 2 + sw_reset_yo]
      key:
        name: sw_reset
        width: sw_reset_x
        height: sw_reset_y

    trackpoint_mount:
      anchor:
        ref.aggregate.parts:
          - matrix_index_top
          - matrix_index_home
          - matrix_inner_top
          - matrix_inner_home
        shift: [0, 0]
      key:
        name: tp_mount
        width: tpm_x
        height: tpm_y

    trackpoint_connector:
      anchor:
        ref: matrix_inner_bottom
        shift: [+kxo + tpc_xo + 0.75, -kyo - tpc_yo + 0.5]
      key:
        name: tp_conn
        width: tpm_x
        height: tpm_y

    text_version:
      anchor:
        ref: matrix_pinky_bottom
        shift: [+kxo * 2, -kyo + 1.5]

pcbs:
  think_corney:
    outlines:
      main:
        outline: board
    footprints:

      # Controller
      promicro:
        what: infused-kim/nice_nano_pretty
        params:
          traces: true
          show_labels: false

          # Pin Assignments (Controller on top facing down)
          # Right Side
          P0: 'TPD'    # Trackpoint Data
          P1: 'TPC'    # Trackpoint Clock
          # GND
          # GND
          P2: 'DPD'   # Display Data
          P3: 'DPC'   # Display Clock
          P4: 'R1'    # Row Top
          P5: 'R2'    # Row Home
          P6: 'R3'    # Row Bottom
          P7: 'R4'    # Row Thumb
          P8: 'F8'    # Free, but could be Num Row
          P9: 'DPE'   # Display CS (nice!view only)

          # Left Side
          # RAW       # Battery Pos
          # GND       # Ground / Battery Neg
          # RST       # Reset pin
          # VCC       # External Power
          P21: 'C0'   # Column Outer
          P20: 'C1'   # Column Pinky
          P19: 'C2'   # Column Ring
          P18: 'C3'   # Column Middle
          P15: 'C4'   # Column Index
          P14: 'C5'   # Column Inner
          P16: 'F16'  # Free, but could be Encoder 1
          P10: 'F10'  # Free, but could be Encoder 2
        where:
          ref: mcu
          shift: [0,0]

      # Key Area
      # Regular keys with hotswap
      choc_hotswap:
        what: infused-kim/choc
        where: [key]
        params:
          reverse: true
          hotswap: true
          hotswap_tht: true
          keycaps: true
          keycaps_x: keycaps_x
          keycaps_y: keycaps_y
          from: "{{column_net}}"
          to: "{{colrow}}"
        adjust:
          shift: [0,0]
          rotate: -180

      # 1.5u thumb key
      choc_hotswap_thumb_inner:
        what: infused-kim/choc
        where: [key_thumb_inner]
        params:
          reverse: true
          hotswap: true
          hotswap_tht: true
          keycaps: true
          keycaps_x: keycaps_thumb_inner_x
          keycaps_y: keycaps_thumb_inner_y
          from: "{{column_net}}"
          to: "{{colrow}}"
        adjust:
          shift: [0,0]
          rotate: -180

      diode:
        what: infused-kim/diode
        where: [key, key_thumb_inner]
        params:
          from: "{{colrow}}"
          to: "{{row_net}}"
          include_tht: false
        adjust:
          shift: [0, 3.8]

      # Prevent cut off of pad by trackpoint mounting hole
      choc_tp_flipped:
        what: infused-kim/choc
        where: [key_tp_flipped]
        params:
          reverse: true
          hotswap: true
          hotswap_tht: true
          keycaps: true
          keycaps_x: keycaps_x
          keycaps_y: keycaps_y
          from: "{{column_net}}"
          to: "{{colrow}}"
        adjust:
          shift: [0,0]
          rotate: 0

      diode_flipped:
        what: infused-kim/diode
        where: [key_tp_flipped]
        params:
          from: "{{colrow}}"
          to: "{{row_net}}"
          include_tht: false
        adjust:
          shift: [0, -3.8]


      # Controller Area
      trackpoint_mount:
        what: infused-kim/trackpoint_mount
        params:
          reverse: true
          show_outline_t430: false
          show_outline_x240: true
        where:
          ref: tp_mount

      display:
        what: infused-kim/nice_view
        params:
          reverse: true
          MOSI: DPD
          SCK: DPC
          CS: DPE
          show_labels: true
          jumpers_at_bottom: true
        where:
          ref: disp

      conn_battery:
        what: infused-kim/conn_molex_pico_ezmate_1x02
        params:
          reverse: true
          pad_1: BAT_P
          pad_2: GND
        where:
          ref: batc
          rotate: 180

      conn_battery_icon:
        what: infused-kim/icon_bat
        params:
          reverse: true
          spacing: 1.5
        where:
          ref: batc
          shift: [0, batc_yo + font_yo + 0.5]
          rotate: 180

      pads_bat:
        what: infused-kim/pads
        params:
          reverse: true
          width: 1.25
          height: 2.5
          space: 1.25
          pads: 2
          net_1: BAT_P
          net_2: GND
        where:
          ref: batp
          rotate: -180

      pads_bat_icon:
        what: infused-kim/icon_bat
        params:
          reverse: true
          spacing: 1.5
        where:
          ref: batp
          shift: [0, batp_yo + font_yo + 0.3]
          rotate: 180

      conn_trackpoint:
        what: infused-kim/conn_molex_pico_ezmate_1x05
        params:
          reverse: true
          side: F
          pad_1: VCC
          pad_2: GND
          pad_3: TPC
          pad_4: TPR
          pad_5: TPD
        where:
          ref: tp_conn
          rotate: 180

      pads_trackpoint:
        what: infused-kim/pads
        params:
          reverse: true
          width: 1
          height: 2
          space: 1
          pads: 5

          net_1: VCC
          net_2: GND
          net_3: TPC
          net_4: TPR
          net_5: TPD

          label_1: VCC
          label_2: GND
          label_3: SCL
          label_4: RST
          label_5: SDA
          label_at_bottom: true
        where:
          ref: tp_conn
          shift: [0, 0]
          rotate: 180

      trackpoint_reset_circuit:
        what: infused-kim/smd_0805
        params:
          reverse: true
          space: 1
          mirror: true
          label_at_bottom: true
          swap_pad_direction: true
          components: 4

          # TP clock pull up resistor 4.7k
          net_1_from: TPC
          net_1_to: VCC
          label_1: TCR

          # TP Reset circuit resistor 100k
          net_2_from: TPR
          net_2_to: GND
          label_2: TRR

          # TP Reset circuit capacitor 2.2uF
          net_3_from: TPR
          net_3_to: VCC
          label_3: TRC

          # TP data pull up resistor 4.7k
          net_4_from: TPD
          net_4_to: VCC
          label_4: TDR

        where:
          ref: tp_conn
          shift: [0, 6]
          rotate: 180

      power_switch:
        what: infused-kim/switch_power
        params:
          reverse: true
          from: BAT_P
          to: RAW
        where:
          ref: sw_power
          rotate: 0

      reset_switch:
        what: infused-kim/switch_reset
        params:
          reverse: true
          from: GND
          to: RST
        where:
          ref: sw_reset
          rotate: 0

      text_version:
        what: infused-kim/text
        params:
          reverse: true
          text: *kb_full_name
        where:
          ref: text_version

      text_jlc_order_num:
        what: infused-kim/text
        params:
          reverse: true
          text: "JLCJLCJLCJLC"
        where:
          ref: text_version
          shift: [0, +1.5]
          rotate: 0

      point_debugger:
        what: infused-kim/point_debugger
        where: true
        params:
          $extends: settings.point_debugger

outlines:

  # Pure key outline.
  raw:
    - what: rectangle
      where: true
      size: [px, py]

  # Key outlines with 0.5mm removed to show key overlaps.
  keys:
    - what: rectangle
      where: true
      size: [kx-0.5,ky-0.5]

  # Actual outline of the board
  board:
    - what: polygon
      operation: stack
      fillet: 0.5
      points:

        # Top
        # Outer
        - ref: matrix_outer_top
          shift: [-kxo - pcb_outline_padding_left, +kyo + pcb_outline_padding_top]
        - ref: matrix_outer_top
          shift: [+kxo, +kyo + pcb_outline_padding_top]

        # Pinky
        - ref: matrix_pinky_top
          shift: [-kxo, +kyo + pcb_outline_padding_top]
        - ref: matrix_pinky_top
          shift: [+kxo, +kyo + pcb_outline_padding_top]

        # Ring
        - ref: matrix_ring_top
          shift: [-kxo, +kyo + pcb_outline_padding_top]
        - ref: matrix_ring_top
          shift: [+kxo, +kyo + pcb_outline_padding_top]

        # Middle
        - ref: matrix_middle_top
          shift: [-kxo, +kyo + pcb_outline_padding_top]
        - ref: matrix_middle_top
          shift: [+kxo, +kyo + pcb_outline_padding_top]

        # Index
        - ref: matrix_index_top
          shift: [-kxo, +kyo + pcb_outline_padding_top]
        - ref: matrix_index_top
          shift: [+kxo, +kyo + pcb_outline_padding_top]

        # Inner
        - ref: matrix_inner_top
          shift: [-kxo, +kyo + pcb_outline_padding_top]
        - ref: matrix_inner_top
          shift: [+kxo, +kyo + pcb_outline_padding_top]

        # Controller
        - ref: mcu
          shift: [-mcu_xo - mcu_spacing_left, +mcu_yo]
        - ref: edge_mcu_top_right

        # Battery Cable Cutout
        - ref: edge_mcu_top_right
          shift: [0, -mcu_y - bat_wire_cutout_offset]
        - ref: edge_mcu_top_right
          shift: [-bat_wire_cutout_width, -mcu_y - bat_wire_cutout_offset]
        - ref: edge_mcu_top_right
          shift: [-bat_wire_cutout_width, -mcu_y - bat_wire_cutout_offset - bat_wire_cutout_height]
        - ref: edge_mcu_top_right
          shift: [0, -mcu_y - bat_wire_cutout_offset - bat_wire_cutout_height]

        # Right Side
        # Inner Thumb
        - ref: edge_thumb_cluster_top
          shift: [0, 0]
        - ref: edge_thumb_cluster_bottom
          shift: [0, 0]

        # Bottom
        # Inner thumb
        - ref: thumbs_home_cluster
          shift: [+kxo, -kyo - pcb_outline_padding_bottom]

        # Outer Thumb
        - ref: thumbs_outer_cluster
          shift: [-kxo, -kyo - pcb_outline_padding_bottom]

        # Pinky y and ring x
        - ref: matrix_pinky_bottom
          shift: [kxo + 1kx, -kyo - pcb_outline_padding_bottom]

        # Outer
        - ref: matrix_outer_bottom
          shift: [-kxo - pcb_outline_padding_left, -kyo - pcb_outline_padding_bottom]

  # Combination preview showing outline and keys.
  combo:
    - name: board
    - operation: subtract
      name: keys
