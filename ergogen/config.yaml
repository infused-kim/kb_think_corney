units:
  # Proxy Spacing Variables
  kx: cx
  ky: cy
  kxo: 0.5 * cx
  kyo: 0.5 * cy
  # Padding Variables
  px: kx + 2
  py: ky + 2

  # Other constants
  mcu_x: 18 + 2.75
  mcu_y: 33
  mcu_xo: 0.5 * mcu_x
  mcu_yo: 0.5 * mcu_y

points:
  zones:

    # Main Key Matrix
    matrix:
      key:
        padding: 1ky
        spread: 1kx

      columns:
        outer:
        pinky:
        ring:
          key.stagger: 4.75
        middle:
          key.stagger: 2.375
        index:
          key.stagger: -2.375
        inner:
          key.stagger: -2.375

      rows:
        bottom:
        home:
        top:

    # Thumb Cluster
    thumbs:
      key:
        padding: 1ky
        spread: 1kx
      anchor:
        ref: matrix_index_bottom
        shift: [-9.5, -19.625]
      columns:
        outer:
        home:
            key:
              splay: -15
              spread: 1kx+2
              stagger: -2.75
        inner:
            key:
              width: 1.5kx
              splay: 75
              spread: 1kx+3.4
              stagger: 1.7
      rows:
        # Thumbs only have one row.
        cluster:

    controller:
      anchor:
        ref: matrix_inner_top
        shift: [kxo + mcu_xo, kyo -2.25 - mcu_yo]
      key:
        name: mcu
        width: mcu_x
        height: mcu_y

outlines:

  # Pure key outline.
  raw:
    - what: rectangle
      where: true
      size: [px, py]

  # Key outlines with 0.5mm removed to show key overlaps.
  keys:
    - what: rectangle
      where: true
      size: [kx-0.5,ky-0.5]

  # Actual outline of the board
  board:
    - what: polygon
      operation: stack
      fillet: 1
      points:

        # Top
        # Outer
        - ref: matrix_outer_top
          shift: [-kxo, +kyo]
        - ref: matrix_outer_top
          shift: [+kxo, +kyo]

        # Pinky
        - ref: matrix_pinky_top
          shift: [-kxo, +kyo]
        - ref: matrix_pinky_top
          shift: [+kxo, +kyo]

        # Ring
        - ref: matrix_ring_top
          shift: [-kxo, +kyo]
        - ref: matrix_ring_top
          shift: [+kxo, +kyo]

        # Middle
        - ref: matrix_middle_top
          shift: [-kxo, +kyo]
        - ref: matrix_middle_top
          shift: [+kxo, +kyo]

        # Index
        - ref: matrix_index_top
          shift: [-kxo, +kyo]
        - ref: matrix_index_top
          shift: [+kxo, +kyo]

        # Inner
        - ref: matrix_inner_top
          shift: [-kxo, +kyo]
        - ref: matrix_inner_top
          shift: [+kxo, +kyo]

        # Controller
        - ref: mcu
          shift: [-mcu_xo, +mcu_yo]
        - ref: mcu
          shift: [+mcu_xo, +mcu_yo]

        # Right Side
        # Inner Thumb
        - ref: thumbs_inner_cluster
          shift: [+1.5kxo, -kyo]
        - ref: thumbs_inner_cluster
          shift: [-1.5kxo, -kyo]

        # Bottom
        # Inner thumb
        - ref: thumbs_inner_cluster
          shift: [-1.5kxo, +kyo]

        # Outer Thumb
        - ref: thumbs_outer_cluster
          shift: [-kxo, -kyo]

        # Pinky y and ring x
        - ref: matrix_pinky_bottom
          shift: [kxo + 1kx, -kyo]

        # Outer
        - ref: matrix_outer_bottom
          shift: [-kxo, -kyo]

  # Combination preview showing outline and keys.
  combo:
    - name: board
    - operation: subtract
      name: keys
